<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="./css/index.css"/>
	</head>
	<body>
		<section id="wrap">
			<div id="login">
				<div class="up"></div>
				<div class="down"></div>
				<span class="line"></span>
			</div>
			<header id="head">
				<div class="headMain">
					<h1 class="logo">
						<img src="img/logo.png"/>
					</h1>
					<div class="musice">
						<audio>
							<source src="img/audio.mp3"></source>
						</audio>
					</div>
					<nav class="nav">
						<ul class="list clearfix">
							<li>
								<a href="javascript:;">
									<div class="up">
										<img src="img/home_gruen.png"/>
									</div>
									<div class="down">
										<img src="img/home.png"/>
									</div>
								</a>
							</li>
							<li>
								<a href="javascript:;">
									<div class="up">Course</div>
									<div class="down">Course</div>
								</a>
							</li>
							<li>
								<a href="javascript:;">
									<div class="up">Works</div>
									<div class="down">Works</div>
								</a>
							</li>
							<li>
								<a href="javascript:;">
									<div class="up">About</div>
									<div class="down">About</div>
								</a>
							</li>
							<li>
								<a href="javascript:;">
									<div class="up">Team</div>
									<div class="down">Team</div>
								</a>
							</li>
						</ul>
					</nav>
					<div class="arrow">
						<img src="img/menuIndicator.png"/>
					</div>
				</div>
			</header>
			<section id="content">
				<ul class="list">
					<li class="home">
						<section>
							<ul class="home1">
								<li class="commonTitle action"><span>one layer</span></li>
								<li class="commonTitle"><span>two layer</span></li>
								<li class="commonTitle"><span>three layer</span></li>
								<li class="commonTitle"><span>four layer</span></li>
							</ul>
							<ul class="home2">
								<li class="action"></li>
								<li></li>
								<li></li>
								<li></li>
							</ul>
						</section>
					</li>
					<li class="course">
						<section >
							<header class="course1 commonTitle">
								<span>EINIGE</span> <br />
								<span>UNSERER</span> <br />
								<span>KUNDEN</span> <br />
							</header>
							<div class="course2 commonText">
								<p>
									Das Kundenvertrauen in unsere Kompetenz ist die notwendige Basis einer erfolgreichen Zusammenarbeit, gleichzeitig aber auch das größte Lob, das man uns entgegenbringen kann. <br />
									Diese und viele weitere große und kleine Kunden vertrauen uns seit Jahren, was uns stolz macht, und dafür sagen wir an dieser Stelle einfach mal.
								</p>
							</div>
							<div class="course3">
								<span class="line"></span>
								<span class="line"></span>
								<span class="line"></span>
								<span class="line"></span>
								<span class="line"></span>
								<div class="item">
									<div class="backFace"></div>
									<div class="face">我从来都不骑</div>
								</div>
								<div class="item">
									<div class="backFace"></div>
									<div class="face">我从来都不骑</div>
								</div>
								<div class="item">
									<div class="backFace"></div>
									<div class="face">我从来都不骑</div>
								</div>
								<div class="item">
									<div class="backFace"></div>
									<div class="face">我从来都不骑</div>
								</div>
								<div class="item">
									<div class="backFace"></div>
									<div class="face">我从来都不骑</div>
								</div>
								<div class="item">
									<div class="backFace"></div>
									<div class="face">我从来都不骑</div>
								</div>
								<div class="item">
									<div class="backFace"></div>
									<div class="face">我从来都不骑</div>
								</div>
								<div class="item">
									<div class="backFace"></div>
									<div class="face">我从来都不骑</div>
								</div>
								<div class="item">
									<div class="backFace"></div>
									<div class="face">我从来都不骑</div>
								</div>
								<div class="item">
									<div class="backFace"></div>
									<div class="face">我从来都不骑</div>
								</div>
								<div class="item">
									<div class="backFace"></div>
									<div class="face">我从来都不骑</div>
								</div>
								<div class="item">
									<div class="backFace"></div>
									<div class="face">我从来都不骑</div>
								</div>
							</div>
							<div class="plane1"></div>
						    <div class="plane2"></div>
						    <div class="plane3"></div>
						</section>
					</li>
					<li class="works">
						<section>
							<header class="works1 commonTitle">
								<span>EINBLICK</span> <br />
								<span>ERKENNTNIS</span> <br />
								<span>ERGEBNIS</span> <br />
							</header>
							<div class="works2">
								<div class="item">
									<img src="img/worksimg1.jpg"/>
									<div class="marks">
										<span>我有一头张晓飞</span>
										<div class="icon"></div>
									</div>
								</div>
								<div class="item">
									<img src="img/worksimg2.jpg"/>
									<div class="marks">
										<span>我有一头张晓飞</span>
										<div class="icon"></div>
									</div>
								</div>
								<div class="item">
									<img src="img/worksimg3.jpg"/>
									<div class="marks">
										<span>我有一头张晓飞</span>
										<div class="icon"></div>
									</div>
								</div>
								<div class="item">
									<img src="img/worksimg4.jpg"/>
									<div class="marks">
										<span>我有一头张晓飞</span>
										<div class="icon"></div>
									</div>
								</div>
							</div>
							<div class="works3"></div>
							<div class="pencel1"></div>
						    <div class="pencel2"></div>
						    <div class="pencel3"></div>
						</section>
					</li>
					<li class="about">
						<section >
							<div class="about1 commonTitle">
								<span>DIE</span> <br />
								<span>SPEZIELLE</span> <br />
								<span>VIELFALT</span> <br />
							</div>
							<div class="about2">
								<p class="commonText">
									Der bunte Medienmix ist die Faszination die uns antreibt und das, was man an uns schätzt. Von A bis Z und von vorne bis hinten nehmen wir Ihr Projekt unter unsere Fittiche und lassen es zu etwas Großartigem heranwachsen.
								</p>
							</div>
							<div class="about3">
								<div class="item">
									<span></span>
									<ul data-src="img/about1.jpg"></ul>
								</div>
								<div class="item">
									<span></span>
									<ul data-src="img/about3.jpg"></ul>
								</div>
							</div>
							<div class="about4"></div>
						</section>
					</li>
					<li class="team">
						<section >
							<header class="team1 commonTitle">
								<span>WIR SIND</span> <br />
								<span>VOXELAIR</span> <br />
							</header>
							<div class="team2">
								<p class="commonText">Wir sind seit 2002 eine Full-Service-Werbeagentur mit Stammsitz in Heimsheim, zwischen Stuttgart und Karlsruhe.</p>
								<p class="commonText">Über 60 Jahre Erfahrung vereinen das gesamte VoxelAir-Team. Dabei hat jedes Voxel neben professionellem Allroundwissen auch sein ganz spezielles Gebiet, um selbst die individuellsten Kundenwünsche schnell und kompetent umzusetzen.</p>
							</div>
							<div class="team3">
								<ul>
									<li></li>
									<li></li>
									<li></li>
									<li></li>
									<li></li>
									<li></li>
									<li></li>
									<li></li>
								</ul>
							</div>
						</section>
					</li>
				</ul>
				<ul class="dot">
					<li class="action"></li>
					<li></li>
					<li></li>
					<li></li>
					<li></li>
				</ul>
			</section>
		</section>
	</body>
	<script type="text/javascript">
		window.onload=function(){
			var liNodes=document.querySelectorAll("#head>.headMain>.nav>.list li");
			var arrowNode=document.querySelector("#head>.headMain>.arrow");
			var upNodes=document.querySelectorAll("#head>.headMain>.nav>.list li .up")
			
			
			var headNode=document.querySelector("#head");
			var contentNode=document.querySelector("#content");
			var contentLisNode=document.querySelectorAll("#content>.list>li");
			var cListNode=document.querySelector("#content>.list");
			
			var home2LiNode=document.querySelectorAll(".home2>li");
			var home1LiNode=document.querySelectorAll(".home1>li");
			var homeNode=document.querySelector(".home");
			
			var ulsNode=document.querySelectorAll(".about3>.item ul");
			
			var dotlisNode=document.querySelectorAll(".dot>li");
			
			var team3=document.querySelector(".team3");
			var teamUl=document.querySelector(".team3>ul");
			var team3lisNode=document.querySelectorAll(".team3>ul>li");
			
			var login=document.querySelector("#login");
			var loginDivs=document.querySelectorAll("#login div")
			var loginLine=document.querySelector("#login .line");
			
			var now=0;
			var timer=0;
			var oldIndex=0;
			var autoIndex=0;
			var timer3d=0;
			var canvas=null;
			//出场位置
			var preIndex=0;
			
			//启动页面
			loadingAn();
			function loadingAn(){
				var arr = ['bg1.jpg','bg2.jpg','bg3.jpg','bg4.jpg','bg5.jpg','about1.jpg','about2.jpg','about3.jpg','about4.jpg','worksimg1.jpg','worksimg2.jpg','worksimg3.jpg','worksimg4.jpg','team.png','greenLine.png'];
				var flag=0;
				for (var i = 0; i < arr.length; i++) {
					var img=new Image();
					img.src="./img/"+arr[i];
					img.onload=function(){
						flag++;
						loginLine.style.width=flag/arr.length*100+"%";
					}
				}
				
				loginLine.addEventListener("transitionend",function(){
					if(flag==arr.length){
						for (var i = 0; i < loginDivs.length; i++) {
							loginDivs[i].style.height=0+"px";
						}
						this.style.display="none";
					}
				});
				
				loginDivs[0].addEventListener("transitionend",function(){
					login.remove();
					audio.play();
				});
			}
			
			//音乐
			var musice=document.querySelector("#head .headMain .musice");
			var audio=document.querySelector("#head .headMain .musice audio");
			musice.onclick=function(){
				if(audio.paused){
					audio.play();
					musice.style.background="url(img/musicon.gif)";
				}else{
					audio.pause();
					musice.style.background="url(img/musicoff.gif)";
				}
			}
			
			//出入场动画
			var animationArr=[
				{
					anIn:function(){
						var home1=document.querySelector("#content .home .home1");
						var home2=document.querySelector("#content .home .home2");
						home1.style.transform="translateY(0)";
						home1.style.opacity=1;
						home2.style.transform="translateY(0)";
						home2.style.opacity=1;
					},
					anOut:function(){
						var home1=document.querySelector("#content .home .home1");
						var home2=document.querySelector("#content .home .home2");
						home1.style.transform="translateY(-200px)";
						home1.style.opacity=0;
						home2.style.transform="translateY(100px)";
						home2.style.opacity=0;
					}
				},
				{
					anIn:function(){
						var plane1=document.querySelector("#content .course .plane1");
						var plane2=document.querySelector("#content .course .plane2");
						var plane3=document.querySelector("#content .course .plane3");
						plane1.style.transform="translate(0px,0px)";
						plane2.style.transform="translate(0px,0px)";
						plane3.style.transform="translate(0px,0px)";
					},
					anOut:function(){
						var plane1=document.querySelector("#content .course .plane1");
						var plane2=document.querySelector("#content .course .plane2");
						var plane3=document.querySelector("#content .course .plane3");
						plane1.style.transform="translate(-200px,-200px)";
						plane2.style.transform="translate(-200px,200px)";
						plane3.style.transform="translate(200px,-200px)";
					}
				},
				{
					anIn:function(){
						var pencel1=document.querySelector("#content .works .pencel1");
						var pencel2=document.querySelector("#content .works .pencel2");
						var pencel3=document.querySelector("#content .works .pencel3");
						pencel1.style.transform="translateY(0px)";
						pencel2.style.transform="translateY(0px)";
						pencel3.style.transform="translateY(0px)";
					},
					anOut:function(){
						var pencel1=document.querySelector("#content .works .pencel1");
						var pencel2=document.querySelector("#content .works .pencel2");
						var pencel3=document.querySelector("#content .works .pencel3");
						pencel1.style.transform="translateY(-200px)";
						pencel2.style.transform="translateY(200px)";
						pencel3.style.transform="translateY(200px)";
					}
				},
				{
					anIn:function(){
						var about1=document.querySelector("#content .about .about3 .item:first-child");
						var about2=document.querySelector("#content .about .about3 .item:last-child");
						about1.style.transform="rotate(0deg)";
						about2.style.transform="rotate(0deg)";
					},
					anOut:function(){
						var about1=document.querySelector("#content .about .about3 .item:first-child");
						var about2=document.querySelector("#content .about .about3 .item:last-child");
						about1.style.transform="rotate(45deg)";
						about2.style.transform="rotate(-45deg)";
					}
				},
				{
					anIn:function(){
						var team1=document.querySelector("#content .team .team1");
						var team2=document.querySelector("#content .team .team2");
						team1.style.transform="translateX(0px)";
						team2.style.transform="translateX(0px)";
					},
					anOut:function(){
						var team1=document.querySelector("#content .team .team1");
						var team2=document.querySelector("#content .team .team2");
						team1.style.transform="translateX(-200px)";
						team2.style.transform="translateX(200px)";
					}
				},
			]
			
			//全部先是出场
			for (var i = 0; i < animationArr.length; i++) {
				animationArr[i]["anOut"]();
			}
			animationArr[0].anOut();
			setTimeout(function(){
				animationArr[0].anIn();
			},2000);
			
			//第五屏动画
			biubiu();
			function biubiu(){
				var timer1=0;
				var timer2=0;
				for (var i = 0; i < team3lisNode.length; i++) {
					team3lisNode[i].onmouseenter=function(){
						for (var i = 0; i < team3lisNode.length; i++) {
							team3lisNode[i].style.opacity=.7;
						}
						this.style.opacity=1;
						addCanvas();
						canvas.style.left=this.offsetLeft+"px";
					}
					
				}
				
				
				//添加canvas
				function addCanvas(){
					if(!canvas){
						canvas=document.createElement("canvas");
						canvas.width=team3lisNode[0].offsetWidth;
						canvas.height=team3lisNode[0].offsetHeight*2/3;
						canvas.onmouseleave=function(){
							for (var i = 0; i < team3lisNode.length; i++) {
								team3lisNode[i].style.opacity=.7;
							}
							removeCanvas();
						}
						team3.appendChild(canvas);
						qipao();
					}
					
				}
				
				//移除气泡
				function removeCanvas(){
					canvas.remove();
					canvas=null;
					clearInterval(timer1);
					clearInterval(timer2);
				}
				
				function qipao(){
					if(canvas.getContext){
						var ctx=canvas.getContext("2d");
						var arr=[];
						timer1=setInterval(function(){
							console.log(arr);
							ctx.clearRect(0,0,canvas.width,canvas.height);
							for (var i = 0; i < arr.length; i++) {
								arr[i].deg+=5;
								arr[i].x=arr[i].startX+Math.sin(arr[i].deg*Math.PI/180)*arr[i].step*2;
								arr[i].y=arr[i].startY-(arr[i].deg*Math.PI/180)*arr[i].step;
								if(arr[i].y<=50){
									arr.splice(i,1);
								}
								
							}
							for (var i = 0; i < arr.length; i++) {
								ctx.save();
								ctx.fillStyle="rgba("+arr[i].red+","+arr[i].green+","+arr[i].blue+","+arr[i].apal+")"
								ctx.beginPath();
								ctx.arc(arr[i].x,arr[i].y,arr[i].r,0,360*Math.PI/180);
								ctx.fill();
								ctx.restore();
								
							}
						},1000/60);
						
						timer2=setInterval(function(){
							var r=Math.random()*6+2;
							var x=Math.random()*canvas.width;
							var y=canvas.height-r;
							
							var red=Math.round(Math.random()*255);
							var green=Math.round(Math.random()*255);
							var blue=Math.round(Math.random()*255);
							var apal=1;
							
							var deg=0;
							var step=Math.random()*20+10;
							var startX=x;
							var startY=y;
							
							return arr.push({
								x:x,
								y:y,
								r:r,
								red:red,
								green:green,
								blue:blue,
								apal:apal,
								deg:deg,
								step:step,
								startX:startX,
								startY:startY
							});
						},50);
					}
				}
			}
			//第四屏动画
			picBoom();
			function picBoom(){
				for (var i = 0; i < ulsNode.length; i++) {
					var w=ulsNode[i].offsetWidth/2;
					var h=ulsNode[i].offsetHeight/2;
					for (var j = 0; j< 4; j++) {
						var li=document.createElement("li");
						li.style.width=w+"px";
						li.style.height=h+"px";
						var img=document.createElement("img");
						img.src=ulsNode[i].dataset.src;
						/**
						 * left:0 top:0
						 * left:-w top:0
						 * left:0 top:-h
						 * left:-w top:-h
						 */
						img.style.left=-(j%2)*w+"px";
						img.style.top=-Math.floor(j/2)*h+"px";
						li.appendChild(img);
						ulsNode[i].appendChild(li);
						
					}
					ulsNode[i].onmouseenter=function(){
						var imgNode=this.querySelectorAll("li>img")
						/**
						 * left:0 top:h
						 * left:-2w top:0
						 * left:w top:-h
						 * left:-w top:-2h
						 */
						imgNode[0].style.top=h+"px";
						imgNode[1].style.left=-2*w+"px";
						imgNode[2].style.left=w+"px";
						imgNode[3].style.top=-2*h+"px";
					}
					ulsNode[i].onmouseleave=function(){
						var imgNode=this.querySelectorAll("li>img")
						/**
						 * left:0 top:0
						 * left:-w top:0
						 * left:0 top:-h
						 * left:-w top:-h
						 */
						imgNode[0].style.top=0+"px";
						imgNode[1].style.left=-w+"px";
						imgNode[2].style.left=0+"px";
						imgNode[3].style.top=-h+"px";
					}
				}
			}
			
			//第一屏3d动画
			home3d();
			function home3d(){
				for (var i = 0; i < home2LiNode.length; i++) {
					home2LiNode[i].index=i;
					home2LiNode[i].onclick=function(){
						clearInterval(timer3d);
						for (var i = 0; i < home2LiNode.length; i++) {
							home2LiNode[i].classList.remove("action");
						}
						this.classList.add("action");
						console.log(this.index);
						//左出右进
						if(this.index>oldIndex){
							home1LiNode[this.index].classList.add("rigthShow");
							home1LiNode[this.index].classList.remove("leftHidden");
							home1LiNode[this.index].classList.remove("leftShow");
							home1LiNode[this.index].classList.remove("rigthHidden");
							
							home1LiNode[oldIndex].classList.add("leftHidden");
							home1LiNode[oldIndex].classList.remove("rigthShow");
							home1LiNode[oldIndex].classList.remove("leftShow");
							home1LiNode[oldIndex].classList.remove("rigthHidden");	
						}
					
						
						//左进右出
						if(this.index<oldIndex){
							
							home1LiNode[this.index].classList.remove("leftHidden");
							home1LiNode[this.index].classList.remove("rigthShow");
							home1LiNode[this.index].classList.remove("rigthHidden");
							home1LiNode[this.index].classList.add("leftShow");
							
							
							home1LiNode[oldIndex].classList.remove("rigthShow");
							home1LiNode[oldIndex].classList.remove("leftShow");
							home1LiNode[oldIndex].classList.remove("leftHidden");
							home1LiNode[oldIndex].classList.add("rigthHidden");
						}
						
						oldIndex=this.index;
						autoIndex=this.index;
						move3d();
					}
						
				}
				//轮播
				move3d();
				function move3d(){
					timer3d=setInterval(function(){
						autoIndex++;
						
						if(autoIndex==home1LiNode.length){
							autoIndex=0;
						}
						
						for (var i = 0; i < home2LiNode.length; i++) {
							home2LiNode[i].classList.remove("action");
						}
						home2LiNode[autoIndex].classList.add("action");
						
						home1LiNode[autoIndex].classList.remove("leftHidden");
						home1LiNode[autoIndex].classList.remove("leftShow");
						home1LiNode[autoIndex].classList.remove("rigthHidden");
						home1LiNode[autoIndex].classList.add("rigthShow");
						
						
						home1LiNode[oldIndex].classList.remove("rigthShow");
						home1LiNode[oldIndex].classList.remove("leftShow");
						home1LiNode[oldIndex].classList.remove("rigthHidden");	
						home1LiNode[oldIndex].classList.add("leftHidden");
						oldIndex=autoIndex;
					},3000);
				}
				homeNode.onmouseenter=function(){
					clearInterval(timer3d);
				}
				homeNode.onmouseleave=function(){
					move3d();
				}
			}
			
			//屏幕尺寸
			window.onresize=function(){
				contentBind();
				cListNode.style.top=-now*(document.documentElement.clientHeight-headNode.offsetHeight)+"px";
			}
			
			//内容区滚轮事件
			if(contentNode.addEventListener){
				contentNode.addEventListener("DOMMouseScroll",function(ev){
					ev=ev||event;
					clearTimeout(timer);
					timer=setTimeout(function(){
						fn(ev);
					},200);
					
				});
			}
			contentNode.onmousewheel=function(ev){
				ev=ev||event;
				clearTimeout(timer);
				timer=setTimeout(function(){
					fn(ev);
				},200);
			};
			function fn(ev){
				var dir="";
				if(ev.wheelDelta){
					dir=ev.wheelDelta>0?"up":"down";
				}else{
					dir=ev.detail<0?"up":"dowm";
				}
				preIndex=now;
				switch (dir){
					case "up":
						if(now>0){
							now--;
							move(now);
						}
						break;
					case "down":
						if(now<liNodes.length-1){
							now++;
							move(now);
						}
						break;
				}
			}
			contentBind();
			//内容区
			function contentBind(){
				contentNode.style.height=document.documentElement.clientHeight-headNode.offsetHeight+"px";
				for (var i = 0; i < contentLisNode.length; i++) {
					contentLisNode[i].style.height=document.documentElement.clientHeight-headNode.offsetHeight+"px";
				}
			}
			
			headBind();
			/**
			 * 头部
			 */
			function headBind(){
				arrowNode.style.left=liNodes[0].offsetLeft+liNodes[0].offsetWidth/2-arrowNode.offsetWidth/2+"px";
				for (var i = 0; i < liNodes.length; i++) {
					liNodes[i].index=i;
					dotlisNode[i].index=i;
					//点击导航栏指示器
					liNodes[i].onclick=function(){
						preIndex=now;
						move(this.index);
						now=this.index;
					}
					//点击右侧指示器
					dotlisNode[i].onclick=function(){
						preIndex=now;
						move(this.index);
						now=this.index;
					}
				}
				
			}
			
			function move(index){
				arrowNode.style.left=liNodes[index].offsetLeft+liNodes[index].offsetWidth/2-arrowNode.offsetWidth/2+"px";
				for (var i = 0; i < upNodes.length; i++) {
					upNodes[i].style.width="";
					dotlisNode[i].className="";
				}
				upNodes[index].style.width="100%";
				cListNode.style.top=-index*(document.documentElement.clientHeight-headNode.offsetHeight)+"px";
				
				dotlisNode[index].className="action";
				
				//出入场
				if(animationArr[index]&&typeof animationArr[index]["anIn"]==="function"){
					animationArr[index]["anIn"]();
				}
				if(animationArr[preIndex]&&typeof animationArr[preIndex]["anOut"]==="function"){
					animationArr[preIndex]["anOut"]();
				}
			}
		}
	</script>
</html>
